/*! For license information please see MotionPathHelper.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).window=t.window||{})}(this,(function(t){"use strict";var e,n=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,i=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,s=Math.PI/180,o=Math.sin,r=Math.cos,a=Math.abs,h=Math.sqrt,l=1e8,c=1e5,d=function(t){return Math.round(t*c)/c||0},u=function(t,e){return e.totalLength=t.totalLength,t.samples?(e.samples=t.samples.slice(0),e.lookup=t.lookup.slice(0),e.minLength=t.minLength,e.resolution=t.resolution):t.totalPoints&&(e.totalPoints=t.totalPoints),e};function p(t){for(var e=[],n=0;n<t.length;n++)e[n]=u(t[n],t[n].slice(0));return u(t,e)}function g(t,e,n,i,s,o,r){for(var a,h,l,c,d,u=t.length;--u>-1;)for(h=(a=t[u]).length,l=0;l<h;l+=2)c=a[l],d=a[l+1],a[l]=c*e+d*i+o,a[l+1]=c*n+d*s+r;return t._dirty=1,t}function f(t,e,n,i,l,c,d,u,p){if(t!==u||e!==p){n=a(n),i=a(i);var g=l%360*s,f=r(g),_=o(g),v=Math.PI,m=2*v,b=(t-u)/2,y=(e-p)/2,A=f*b+_*y,w=-_*b+f*y,P=A*A,x=w*w,C=P/(n*n)+x/(i*i);C>1&&(n=h(C)*n,i=h(C)*i);var S=n*n,E=i*i,k=(S*E-S*x-E*P)/(S*x+E*P);k<0&&(k=0);var M=(c===d?-1:1)*h(k),D=M*(n*w/i),T=M*(-i*A/n),H=(t+u)/2+(f*D-_*T),N=(e+p)/2+(_*D+f*T),R=(A-D)/n,L=(w-T)/i,X=(-A-D)/n,I=(-w-T)/i,O=R*R+L*L,q=(L<0?-1:1)*Math.acos(R/h(O)),Y=(R*I-L*X<0?-1:1)*Math.acos((R*X+L*I)/h(O*(X*X+I*I)));isNaN(Y)&&(Y=v),!d&&Y>0?Y-=m:d&&Y<0&&(Y+=m),q%=m,Y%=m;var j,V=Math.ceil(a(Y)/(m/4)),z=[],G=Y/V,B=4/3*o(G/2)/(1+r(G/2)),W=f*n,F=_*n,U=_*-i,Z=f*i;for(j=0;j<V;j++)A=r(l=q+j*G),w=o(l),R=r(l+=G),L=o(l),z.push(A-B*w,w+B*A,R+B*L,L-B*R,R,L);for(j=0;j<z.length;j+=2)A=z[j],w=z[j+1],z[j]=A*W+w*U+H,z[j+1]=A*F+w*Z+N;return z[j-2]=u,z[j-1]=p,z}}function _(t){var e,s,o,r,h,l,c,d,u,p,g,_,v,m,b,y=(t+"").replace(i,(function(t){var e=+t;return e<1e-4&&e>-1e-4?0:e})).match(n)||[],A=[],w=0,P=0,x=2/3,C=y.length,S=0,E="ERROR: malformed path: "+t,k=function(t,e,n,i){p=(n-t)/3,g=(i-e)/3,c.push(t+p,e+g,n-p,i-g,n,i)};if(!t||!isNaN(y[0])||isNaN(y[1]))return console.log(E),A;for(e=0;e<C;e++)if(v=h,isNaN(y[e])?l=(h=y[e].toUpperCase())!==y[e]:e--,o=+y[e+1],r=+y[e+2],l&&(o+=w,r+=P),e||(d=o,u=r),"M"===h)c&&(c.length<8?A.length-=1:S+=c.length),w=d=o,P=u=r,c=[o,r],A.push(c),e+=2,h="L";else if("C"===h)c||(c=[0,0]),l||(w=P=0),c.push(o,r,w+1*y[e+3],P+1*y[e+4],w+=1*y[e+5],P+=1*y[e+6]),e+=6;else if("S"===h)p=w,g=P,"C"!==v&&"S"!==v||(p+=w-c[c.length-4],g+=P-c[c.length-3]),l||(w=P=0),c.push(p,g,o,r,w+=1*y[e+3],P+=1*y[e+4]),e+=4;else if("Q"===h)p=w+(o-w)*x,g=P+(r-P)*x,l||(w=P=0),w+=1*y[e+3],P+=1*y[e+4],c.push(p,g,w+(o-w)*x,P+(r-P)*x,w,P),e+=4;else if("T"===h)p=w-c[c.length-4],g=P-c[c.length-3],c.push(w+p,P+g,o+(w+1.5*p-o)*x,r+(P+1.5*g-r)*x,w=o,P=r),e+=2;else if("H"===h)k(w,P,w=o,P),e+=1;else if("V"===h)k(w,P,w,P=o+(l?P-w:0)),e+=1;else if("L"===h||"Z"===h)"Z"===h&&(o=d,r=u,c.closed=!0),("L"===h||a(w-o)>.5||a(P-r)>.5)&&(k(w,P,o,r),"L"===h&&(e+=2)),w=o,P=r;else if("A"===h){if(m=y[e+4],b=y[e+5],p=y[e+6],g=y[e+7],s=7,m.length>1&&(m.length<3?(g=p,p=b,s--):(g=b,p=m.substr(2),s-=2),b=m.charAt(1),m=m.charAt(0)),_=f(w,P,+y[e+1],+y[e+2],+y[e+3],+m,+b,(l?w:0)+1*p,(l?P:0)+1*g),e+=s,_)for(s=0;s<_.length;s++)c.push(_[s]);w=c[c.length-2],P=c[c.length-1]}else console.log(E);return(e=c.length)<6?(A.pop(),e=0):c[0]===c[e-2]&&c[1]===c[e-1]&&(c.closed=!0),A.totalPoints=S+e,A}function v(t,e,n,i,s,o,r,h,l,c,d){var u,p=(t+n)/2,g=(e+i)/2,f=(n+s)/2,_=(i+o)/2,m=(s+r)/2,b=(o+h)/2,y=(p+f)/2,A=(g+_)/2,w=(f+m)/2,P=(_+b)/2,x=(y+w)/2,C=(A+P)/2,S=r-t,E=h-e,k=a((n-r)*E-(i-h)*S),M=a((s-r)*E-(o-h)*S);return c||(c=[t,e,r,h],d=2),c.splice(d||c.length-2,0,x,C),(k+M)*(k+M)>l*(S*S+E*E)&&(u=c.length,v(t,e,p,g,y,A,x,C,l,c,d),v(x,C,w,P,m,b,r,h,l,c,d+2+(c.length-u))),c}function m(t,e){a(t[0]-t[2])<1e-4&&a(t[1]-t[3])<1e-4&&(t=t.slice(2));var n,i,s,o,r,l,c,u,p,g,f,_,v,m,b=t.length-2,y=+t[0],A=+t[1],w=+t[2],P=+t[3],x=[y,A,y,A],C=w-y,S=P-A,E=Math.abs(t[b]-y)<.001&&Math.abs(t[b+1]-A)<.001;for(E&&(t.push(w,P),w=y,P=A,y=t[b-2],A=t[b-1],t.unshift(y,A),b+=4),e=e||0===e?+e:1,s=2;s<b;s+=2)n=y,i=A,y=w,A=P,w=+t[s+2],P=+t[s+3],y===w&&A===P||(o=C,r=S,C=w-y,S=P-A,u=((l=h(o*o+r*r))+(c=h(C*C+S*S)))*e*.25/h(Math.pow(C/c+o/l,2)+Math.pow(S/c+r/l,2)),f=y-((p=y-(y-n)*(l?u/l:0))+(((g=y+(w-y)*(c?u/c:0))-p)*(3*l/(l+c)+.5)/4||0)),m=A-((_=A-(A-i)*(l?u/l:0))+(((v=A+(P-A)*(c?u/c:0))-_)*(3*l/(l+c)+.5)/4||0)),y===n&&A===i||x.push(d(p+f),d(_+m),d(y),d(A),d(g+f),d(v+m)));return y!==w||A!==P||x.length<4?x.push(d(w),d(P),d(w),d(P)):x.length-=2,2===x.length?x.push(y,A,y,A,y,A):E&&(x.splice(0,6),x.length=x.length-6),x}function b(t,e,n,i,s){var o,r,a,h,l,c,d,u,p,g,f,_,v=i,m=t[e],y=t[e+1],A=t[n],w=t[n+1];for(r=e+2;r<n;r+=2)h=t[r],l=t[r+1],g=void 0,void 0,void 0,_=(p=w)-(d=y),((f=(u=A)-(c=m))||_)&&((g=((h-c)*f+(l-d)*_)/(f*f+_*_))>1?(c=u,d=p):g>0&&(c+=f*g,d+=_*g)),(a=Math.pow(h-c,2)+Math.pow(l-d,2))>v&&(o=r,v=a);v>i&&(o-e>2&&b(t,e,o,i,s),s.push(t[o],t[o+1]),n-o>2&&b(t,o,n,i,s))}function y(t,e){var n,i,s,o,r,a,h,l=parseFloat(t[0]),c=parseFloat(t[1]),d=[l,c],u=t.length-2;for(e=Math.pow(e||1,2),n=2;n<u;n+=2)(o=l-(i=parseFloat(t[n])))*o+(r=c-(s=parseFloat(t[n+1])))*r>e&&(d.push(i,s),l=i,c=s);return d.push(parseFloat(t[u]),parseFloat(t[u+1])),b(d,0,h=d.length-2,e,a=[d[0],d[1]]),a.push(d[h],d[h+1]),a}function A(t,n,i,s,o,r,a,h,c,d,u,p,g,f){var _,v,m,b,y=(o-s)/r,w=0,P=s;for(e=l;P<=o;)(_=(v=(b=1-P)*b*b*a+3*b*b*P*c+3*b*P*P*u+P*P*P*g-n)*v+(m=b*b*b*h+3*b*b*P*d+3*b*P*P*p+P*P*P*f-i)*m)<e&&(e=_,w=P),P+=y;return t>1?A(t-1,n,i,Math.max(w-y,0),Math.min(w+y,1),r,a,h,c,d,u,p,g,f):w}var w,P,x,C,S,E,k,M,D,T="transform",H=T+"Origin",N=function(t){var e=t.ownerDocument||t;!(T in t.style)&&"msTransform"in t.style&&(H=(T="msTransform")+"Origin");for(;e.parentNode&&(e=e.parentNode););if(P=window,k=new Y,e){w=e,x=e.documentElement,C=e.body,(M=w.createElementNS("http://www.w3.org/2000/svg","g")).style.transform="none";var n=e.createElement("div"),i=e.createElement("div"),s=e&&(e.body||e.firstElementChild);s&&s.appendChild&&(s.appendChild(n),n.appendChild(i),n.setAttribute("style","position:static;transform:translate3d(0,0,1px)"),D=i.offsetParent!==n,s.removeChild(n))}return e},R=[],L=[],X=function(t){return t.ownerSVGElement||("svg"===(t.tagName+"").toLowerCase()?t:null)},I=function t(e){return"fixed"===P.getComputedStyle(e).position||((e=e.parentNode)&&1===e.nodeType?t(e):void 0)},O=function t(e,n){if(e.parentNode&&(w||N(e))){var i=X(e),s=i?i.getAttribute("xmlns")||"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",o=i?n?"rect":"g":"div",r=2!==n?0:100,a=3===n?100:0,h="position:absolute;display:block;pointer-events:none;margin:0;padding:0;",l=w.createElementNS?w.createElementNS(s.replace(/^https/,"http"),o):w.createElement(o);return n&&(i?(E||(E=t(e)),l.setAttribute("width",.01),l.setAttribute("height",.01),l.setAttribute("transform","translate("+r+","+a+")"),E.appendChild(l)):(S||((S=t(e)).style.cssText=h),l.style.cssText=h+"width:0.1px;height:0.1px;top:"+a+"px;left:"+r+"px",S.appendChild(l))),l}throw"Need document and parent."},q=function(t,e,n,i,s,o,r){return t.a=e,t.b=n,t.c=i,t.d=s,t.e=o,t.f=r,t},Y=function(){function t(t,e,n,i,s,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===s&&(s=0),void 0===o&&(o=0),q(this,t,e,n,i,s,o)}var e=t.prototype;return e.inverse=function(){var t=this.a,e=this.b,n=this.c,i=this.d,s=this.e,o=this.f,r=t*i-e*n||1e-10;return q(this,i/r,-e/r,-n/r,t/r,(n*o-i*s)/r,-(t*o-e*s)/r)},e.multiply=function(t){var e=this.a,n=this.b,i=this.c,s=this.d,o=this.e,r=this.f,a=t.a,h=t.c,l=t.b,c=t.d,d=t.e,u=t.f;return q(this,a*e+l*i,a*n+l*s,h*e+c*i,h*n+c*s,o+d*e+u*i,r+d*n+u*s)},e.clone=function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)},e.equals=function(t){var e=this.a,n=this.b,i=this.c,s=this.d,o=this.e,r=this.f;return e===t.a&&n===t.b&&i===t.c&&s===t.d&&o===t.e&&r===t.f},e.apply=function(t,e){void 0===e&&(e={});var n=t.x,i=t.y,s=this.a,o=this.b,r=this.c,a=this.d,h=this.e,l=this.f;return e.x=n*s+i*r+h||0,e.y=n*o+i*a+l||0,e},t}();function j(t,e,n,i){if(!t||!t.parentNode||(w||N(t)).documentElement===t)return new Y;var s=function(t){for(var e,n;t&&t!==C;)(n=t._gsap)&&n.uncache&&n.get(t,"x"),n&&!n.scaleX&&!n.scaleY&&n.renderTransform&&(n.scaleX=n.scaleY=1e-4,n.renderTransform(1,n),e?e.push(n):e=[n]),t=t.parentNode;return e}(t),o=X(t)?R:L,r=function(t,e){var n,i,s,o,r,a,h=X(t),l=t===h,c=h?R:L,d=t.parentNode,u=d&&!h&&d.shadowRoot&&d.shadowRoot.appendChild?d.shadowRoot:d;if(t===P)return t;if(c.length||c.push(O(t,1),O(t,2),O(t,3)),n=h?E:S,h)l?(s=function(t){var e,n=t.getCTM();return n||(e=t.style[T],t.style[T]="none",t.appendChild(M),n=M.getCTM(),t.removeChild(M),e?t.style[T]=e:t.style.removeProperty(T.replace(/([A-Z])/g,"-$1").toLowerCase())),n||k.clone()}(t),o=-s.e/s.a,r=-s.f/s.d,i=k):t.getBBox?(s=t.getBBox(),o=(i=(i=t.transform?t.transform.baseVal:{}).numberOfItems?i.numberOfItems>1?function(t){for(var e=new Y,n=0;n<t.numberOfItems;n++)e.multiply(t.getItem(n).matrix);return e}(i):i.getItem(0).matrix:k).a*s.x+i.c*s.y,r=i.b*s.x+i.d*s.y):(i=new Y,o=r=0),e&&"g"===t.tagName.toLowerCase()&&(o=r=0),(l?h:d).appendChild(n),n.setAttribute("transform","matrix("+i.a+","+i.b+","+i.c+","+i.d+","+(i.e+o)+","+(i.f+r)+")");else{if(o=r=0,D)for(i=t.offsetParent,s=t;s&&(s=s.parentNode)&&s!==i&&s.parentNode;)(P.getComputedStyle(s)[T]+"").length>4&&(o=s.offsetLeft,r=s.offsetTop,s=0);if("absolute"!==(a=P.getComputedStyle(t)).position&&"fixed"!==a.position)for(i=t.offsetParent;d&&d!==i;)o+=d.scrollLeft||0,r+=d.scrollTop||0,d=d.parentNode;(s=n.style).top=t.offsetTop-r+"px",s.left=t.offsetLeft-o+"px",s[T]=a[T],s[H]=a[H],s.position="fixed"===a.position?"fixed":"absolute",u.appendChild(n)}return n}(t,n),a=o[0].getBoundingClientRect(),h=o[1].getBoundingClientRect(),l=o[2].getBoundingClientRect(),c=r.parentNode,d=!i&&I(t),u=new Y((h.left-a.left)/100,(h.top-a.top)/100,(l.left-a.left)/100,(l.top-a.top)/100,a.left+(d?0:P.pageXOffset||w.scrollLeft||x.scrollLeft||C.scrollLeft||0),a.top+(d?0:P.pageYOffset||w.scrollTop||x.scrollTop||C.scrollTop||0));if(c.removeChild(r),s)for(a=s.length;a--;)(h=s[a]).scaleX=h.scaleY=0,h.renderTransform(1,h);return e?u.inverse():u}var V,z,G,B,W,F,U,Z,$,K,Q,J,tt,et,nt,it=/(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,st="#4e7fff",ot=(Math.PI,Date.now||function(){return(new Date).getTime()}),rt=0,at=0,ht=function(){return!1},lt={},ct=[],dt={},ut=[],pt=",",gt=[],ft=function(t){t.preventDefault&&(t.preventDefault(),t.preventManipulation&&t.preventManipulation())},_t=function(t){return V.createElementNS?V.createElementNS("http://www.w3.org/1999/xhtml",t):V.createElement(t)},vt=function(t,e,n){var i,s=V.createElementNS("http://www.w3.org/2000/svg",t),o=/([a-z])([A-Z])/g;for(i in(n=n||{}).class=n.class||"path-editor",n)void 0!==s.style[i]?s.style[i]=n[i]:s.setAttributeNS(null,i.replace(o,"$1-$2").toLowerCase(),n[i]);return e.appendChild(s),s},mt={matrix:new Y},bt=function(t){return(t.transform&&t.transform.baseVal.consolidate()||mt).matrix},yt=function(t){return~~(1e3*t+(t<0?-.5:.5))/1e3},At=function(t){if(!t.target._gsSelection&&!at&&ot()-rt>100){for(var e=gt.length;--e>-1;)gt[e].deselect();gt.length=0}},wt=0,Pt=function(t,e,n,i){if(t.addEventListener){var s=tt[e];i=i||{passive:!1},t.addEventListener(s||e,n,i),s&&e!==s&&"pointer"!==s.substr(0,7)&&t.addEventListener(e,n,i)}else t.attachEvent&&t.attachEvent("on"+e,n)},xt=function(t,e,n){if(t.removeEventListener){var i=tt[e];t.removeEventListener(i||e,n),i&&e!==i&&"pointer"!==i.substr(0,7)&&t.removeEventListener(e,n)}else t.detachEvent&&t.detachEvent("on"+e,n)},Ct=function t(e){wt=e.touches&&_dragCount<e.touches.length,xt(e.target,"touchend",t)},St=function(t){wt=t.touches&&_dragCount<t.touches.length,Pt(t.target,"touchend",Ct)},Et=function(t,e){return function(n){return t.call(e,n)}},kt=function(t,e,n){var i=e.vars[t];return i&&i.call(e.vars.callbackScope||e,n||e),e},Mt=function(){et.style.display="block",et.select(),et.style.display="none"},Dt=function(t){V=document,G=window,B=V.body,W=W||t||G.gsap||console.warn("Please gsap.registerPlugin(PathEditor)"),F=W&&W.core.context||function(){},J=_t("div"),(et=_t("textarea")).style.display="none",B&&B.appendChild(et),tt=function(t){for(var e=t.split(","),n=(void 0!==J.onpointerdown?"pointerdown,pointermove,pointerup,pointercancel":void 0!==J.onmspointerdown?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":t).split(","),i={},s=4;--s>-1;)i[e[s]]=n[s],i[n[s]]=e[s];return i}("touchstart,touchmove,touchend,touchcancel"),SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(t){return t.getScreenCTM().inverse().multiply(this.getScreenCTM())},V.addEventListener("keydown",(function(t){var e,n,i,s,o=t.keyCode||t.which,r=t.key||o;if("Shift"===r||16===o)$=!0;else if("Control"===r||17===o)U=!0;else if("Meta"===r||91===o)K=!0;else if("Alt"===r||18===o)for(Z=!0,e=gt.length;--e>-1;)gt[e]._onPressAlt();else if(("z"===r||90===o)&&(U||K)&&ct.length>1){if(ct.shift(),n=ct[0]){for((s=n.path).path.setAttribute("d",n.d),s.path.setAttribute("transform",n.transform),s.init(),i=s._anchors,e=0;e<i.length;e++)-1!==n.selectedIndexes.indexOf(i[e].i)&&s._selectedAnchors.push(i[e]);s._updateAnchors(),s.update(),s.vars.onUndo&&s.vars.onUndo.call(s)}}else if("Delete"===r||"Backspace"===r||8===o||46===o||63272===o||"d"===o&&(U||K))for(e=gt.length;--e>-1;)gt[e]._deleteSelectedAnchors();else if(("a"===r||65===o)&&(K||U))for(e=gt.length;--e>-1;)gt[e].select(!0)}),!0),V.addEventListener("keyup",(function(t){var e=t.key||t.keyCode||t.which;if("Shift"===e||16===e)$=!1;else if("Control"===e||17===e)U=!1;else if("Meta"===e||91===e)K=!1;else if("Alt"===e||18===e){Z=!1;for(var n=gt.length;--n>-1;)gt[n]._onReleaseAlt()}}),!0),z=!!G.PointerEvent,Pt(V,"mouseup",At),Pt(V,"touchend",At),Pt(V,"touchcancel",ht),Pt(G,"touchmove",ht),B&&B.addEventListener("touchstart",ht),nt=1},Tt=function(t){var e,n,i=this,s=j(i.target.parentNode,!0);this._matrix=this.target.transform.baseVal.getItem(0).matrix,this._ctm=s,tt[t.type]?(e=-1!==t.type.indexOf("touch")?t.currentTarget||t.target:V,Pt(e,"touchend",i._onRelease),Pt(e,"touchmove",i._onMove),Pt(e,"touchcancel",i._onRelease),Pt(V,"touchstart",St),Pt(G,"touchforcechange",ft)):(e=null,Pt(V,"mousemove",i._onMove)),z||Pt(V,"mouseup",i._onRelease),ft(t),Mt(),t.changedTouches?(t=i.touch=t.changedTouches[0],i.touchID=t.identifier):t.pointerId?i.touchID=t.pointerId:i.touch=i.touchID=null,i._startPointerY=i.pointerY=t.pageY,i._startPointerX=i.pointerX=t.pageX,i._startElementX=i._matrix.e,i._startElementY=i._matrix.f,1===this._ctm.a&&0===this._ctm.b&&0===this._ctm.c&&1===this._ctm.d?this._ctm=null:(n=i._startPointerX*this._ctm.a+i._startPointerY*this._ctm.c+this._ctm.e,i._startPointerY=i._startPointerX*this._ctm.b+i._startPointerY*this._ctm.d+this._ctm.f,i._startPointerX=n),i.isPressed=at=!0,i.touchEventTarget=e,i.vars.onPress&&i.vars.onPress.call(i.vars.callbackScope||i,i.pointerEvent)},Ht=function(t){var e,n,i=this,s=t;if(i._enabled&&!wt&&i.isPressed&&t){if(i.pointerEvent=t,e=t.changedTouches){if((t=e[0])!==i.touch&&t.identifier!==i.touchID){for(n=e.length;--n>-1&&(t=e[n]).identifier!==i.touchID;);if(n<0)return}}else if(t.pointerId&&i.touchID&&t.pointerId!==i.touchID)return;ft(s),i.setPointerPosition(t.pageX,t.pageY),i.vars.onDrag&&i.vars.onDrag.call(i.vars.callbackScope||i,i.pointerEvent)}},Nt=function(t,e){var n=this;if(n._enabled&&n.isPressed&&(!t||null==n.touchID||e||!(t.pointerId&&t.pointerId!==n.touchID||t.changedTouches&&!function(t,e){for(var n=t.length;--n>-1;)if(t[n].identifier===e)return!0;return!1}(t.changedTouches,n.touchID)))){rt=ot(),n.isPressed=at=!1;var i,s,o=t,r=n.isDragging,a=n.touchEventTarget;if(a?(xt(a,"touchend",n._onRelease),xt(a,"touchmove",n._onMove),xt(a,"touchcancel",n._onRelease),xt(V,"touchstart",St)):xt(V,"mousemove",n._onMove),z||(xt(V,"mouseup",n._onRelease),t&&t.target&&xt(t.target,"mouseup",n._onRelease)),r?n.isDragging=!1:n.vars.onClick&&n.vars.onClick.call(n.vars.callbackScope||n,o),t){if((i=t.changedTouches)&&(t=i[0])!==n.touch&&t.identifier!==n.touchID){for(s=i.length;--s>-1&&(t=i[s]).identifier!==n.touchID;);if(s<0)return}n.pointerEvent=o,n.pointerX=t.pageX,n.pointerY=t.pageY}return o&&!r&&n.vars.onDragRelease?n.vars.onDragRelease.call(n,n.pointerEvent):(o&&ft(o),n.vars.onRelease&&n.vars.onRelease.call(n.vars.callbackScope||n,n.pointerEvent)),r&&n.vars.onDragEnd&&n.vars.onDragEnd.call(n.vars.callbackScope||n,n.pointerEvent),!0}},Rt=function(t,e,n,i){var s,o=t[e],r=o.length-(o.closed?6:0),a=[];for(s=0;s<r;s+=6)a.push(new It(n,t,e,s,i));return o.closed&&(a[0].isClosedStart=!0),a},Lt=function(t,e,n){var i=t[n]-t[e],s=t[n+1]-t[e+1];return Math.sqrt(i*i+s*s)},Xt=function(){function t(t,e){this.target="string"==typeof t?V.querySelectorAll(t)[0]:t,this.vars=e||{},this._onPress=Et(Tt,this),this._onMove=Et(Ht,this),this._onRelease=Et(Nt,this),this.target.setAttribute("transform",(this.target.getAttribute("transform")||"")+" translate(0,0)"),this._matrix=bt(this.target),this.x=this._matrix.e,this.y=this._matrix.f,this.snap=e.snap,isNaN(e.maxX)&&isNaN(e.minX)?this._bounds=0:(this._bounds=1,this.maxX=+e.maxX,this.minX=+e.minX),this.enabled(!0)}var e=t.prototype;return e.setPointerPosition=function(t,e){var n,i,s,o,r,a=1e3;this.pointerX=t,this.pointerY=e,this._ctm&&(r=t*this._ctm.a+e*this._ctm.c+this._ctm.e,e=t*this._ctm.b+e*this._ctm.d+this._ctm.f,t=r),(i=e-this._startPointerY)<1&&i>-1&&(i=0),(n=t-this._startPointerX)<1&&n>-1&&(n=0),s=((this._startElementX+n)*a|0)/a,o=((this._startElementY+i)*a|0)/a,this.snap&&!$&&(dt.x=s,dt.y=o,this.snap.call(this,dt),s=dt.x,o=dt.y),this.x===s&&this.y===o||(this._matrix.f=this.y=o,this._matrix.e=this.x=s,!this.isDragging&&this.isPressed&&(this.isDragging=!0,kt("onDragStart",this,this.pointerEvent)))},e.enabled=function(t){return arguments.length?(this._enabled=t,t?(z||Pt(this.target,"mousedown",this._onPress),Pt(this.target,"touchstart",this._onPress),Pt(this.target,"click",this._onClick,!0)):(e=this.isDragging,xt(this.target,"mousedown",this._onPress),xt(this.target,"touchstart",this._onPress),xt(G,"touchforcechange",ft),xt(this.target,"click",this._onClick),this.touchEventTarget&&(xt(this.touchEventTarget,"touchcancel",this._onRelease),xt(this.touchEventTarget,"touchend",this._onRelease),xt(this.touchEventTarget,"touchmove",this._onMove)),xt(V,"mouseup",this._onRelease),xt(V,"mousemove",this._onMove),this.isDragging=this.isPressed=!1,e&&kt("onDragEnd",this,this.pointerEvent)),this):this._enabled;var e},e.endDrag=function(t){this._onRelease(t)},t}(),It=function(){function t(t,e,n,i,s){this.editor=t,this.element=vt("path",t._selection,{fill:st,stroke:st,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this.update(e,n,i),this.element._gsSelection=!0,this.vars=s||{},this._draggable=new Xt(this.element,{callbackScope:this,onDrag:this.onDrag,snap:this.vars.snap,onPress:this.onPress,onRelease:this.onRelease,onClick:this.onClick,onDragEnd:this.onDragEnd})}var e=t.prototype;return e.onPress=function(){kt("onPress",this)},e.onClick=function(){kt("onClick",this)},e.onDrag=function(){var t=this.segment;this.vars.onDrag.call(this.vars.callbackScope||this,this,this._draggable.x-t[this.i],this._draggable.y-t[this.i+1])},e.onDragEnd=function(){kt("onDragEnd",this)},e.onRelease=function(){kt("onRelease",this)},e.update=function(t,e,n){t&&(this.rawPath=t),arguments.length<=1?(e=this.j,n=this.i):(this.j=e,this.i=n);var i=this.smooth,s=this.rawPath[e],o=0===n&&s.closed?s.length-4:n-2;this.segment=s,this.smooth=n>0&&n<s.length-2&&Math.abs(Math.atan2(s[n+1]-s[o+1],s[n]-s[o])-Math.atan2(s[n+3]-s[n+1],s[n+2]-s[n]))<.09?2:0,this.smooth!==i&&this.element.setAttribute("d",this.smooth?this.editor._circleHandle:this.editor._squareHandle),this.element.setAttribute("transform","translate("+s[n]+","+s[n+1]+")")},t}(),Ot=function(){function t(t,e){e=e||{},nt||Dt(),this.vars=e,this.path="string"==typeof t?V.querySelectorAll(t)[0]:t,this._g=vt("g",this.path.ownerSVGElement,{class:"path-editor-g path-editor"}),this._selectionHittest=vt("path",this._g,{stroke:"transparent",strokeWidth:16,fill:"none",vectorEffect:"non-scaling-stroke"}),this._selection=e._selection||vt("g",this._g,{class:"path-editor-selection path-editor"}),this._selectionPath=vt("path",this._selection,{stroke:st,strokeWidth:2,fill:"none",vectorEffect:"non-scaling-stroke"}),this._selectedAnchors=[],this._line1=vt("polyline",this._selection,{stroke:st,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this._line2=vt("polyline",this._selection,{stroke:st,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this._line1.style.pointerEvents=this._line2.style.pointerEvents=this._selectionPath.style.pointerEvents="none",this._enabled=!0;var n=this.path.parentNode.getScreenCTM().inverse(),i=(n.a+n.d)/2*(e.handleSize||5);this._squareHandle=function(t){return["M-"+(t=yt(t)),-t,t,-t,t,t,-t,t+"z"].join(pt)}(i),this._circleHandle=function(t){var e=yt(.552284749831*t);return"M"+(t=yt(t))+",0C"+[t,e,e,t,0,t,-e,t,-t,e,-t,0,-t,-e,-e,-t,0,-t,e,-t,t,-e,t,0].join(pt)+"z"}(1.15*i),this._handle1=vt("path",this._selection,{d:this._squareHandle,fill:st,stroke:"transparent",strokeWidth:6}),this._handle2=vt("path",this._selection,{d:this._squareHandle,fill:st,stroke:"transparent",strokeWidth:6}),this._handle1._draggable=new Xt(this._handle1,{onDrag:this._onDragHandle1,callbackScope:this,onPress:this._onPressHandle1,onRelease:this._onReleaseHandle,onClick:this._onClickHandle1,snap:e.handleSnap}),this._handle2._draggable=new Xt(this._handle2,{onDrag:this._onDragHandle2,callbackScope:this,onPress:this._onPressHandle2,onRelease:this._onReleaseHandle,onClick:this._onClickHandle2,snap:e.handleSnap}),this._handle1.style.visibility=this._handle2.style.visibility="hidden";for(var s=[this._handle1,this._handle2,this._line1,this._line2,this._selection,this._selectionPath,this._selectionHittest],o=s.length;--o>-1;)s[o]._gsSelection=!0;!1!==e.draggable&&(this._draggable=new Xt(this._selectionHittest,{callbackScope:this,onPress:this.select,onRelease:this._onRelease,onDrag:this._onDragPath,onDragEnd:this._saveState,maxX:this.vars.maxX,minX:this.vars.minX})),this.init(),this._selection.style.visibility=!1===e.selected?"hidden":"visible",!1!==e.selected&&(this.path._gsSelection=!0,gt.push(this)),this._saveState(),z||(Pt(this._selectionHittest,"mousedown",Et(this._onClickSelectionPath,this)),Pt(this._selectionHittest,"mouseup",Et(this._onRelease,this))),Pt(this._selectionHittest,"touchstart",Et(this._onClickSelectionPath,this)),Pt(this._selectionHittest,"touchend",Et(this._onRelease,this)),F(this)}var n=t.prototype;return n._onRelease=function(t){var e=this._editingAnchor;e&&(lt.x=e.segment[e.i],lt.y=e.segment[e.i+1]),xt(G,"touchforcechange",ft),kt("onRelease",this,t)},n.init=function(){var t,e,n=this.path.getAttribute("d"),i=_(n),s=this.path.getAttribute("transform")||"translate(0,0)",o=!this._rawPath||i.totalPoints!==this._rawPath.totalPoints||i.length!==this._rawPath.length,r={callbackScope:this,snap:this.vars.anchorSnap,onDrag:this._onDragAnchor,onPress:this._onPressAnchor,onRelease:this._onRelease,onClick:this._onClickAnchor,onDragEnd:this._onDragEndAnchor,maxX:this.vars.maxX,minX:this.vars.minX};if(o&&this._anchors&&this._anchors.length){for(e=0;e<this._anchors.length;e++)this._anchors[e].element.parentNode.removeChild(this._anchors[e].element),this._anchors[e]._draggable.enabled(!1);this._selectedAnchors.length=0}if(this._rawPath=i,o){if(this._anchors=Rt(i,0,this,r),(t=i.length)>1)for(e=1;e<t;e++)this._anchors=this._anchors.concat(Rt(i,e,this,r))}else for(e=this._anchors.length;--e>-1;)this._anchors[e].update(i);return this._selection.appendChild(this._handle1),this._selection.appendChild(this._handle2),this._selectionPath.setAttribute("d",n),this._selectionHittest.setAttribute("d",n),this._g.setAttribute("transform",function(t){for(var e=bt(t),n=t.ownerSVGElement;(t=t.parentNode)&&t.ownerSVGElement===n;)e.multiply(bt(t));return"matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")"}(this.path.parentNode)||"translate(0,0)"),this._selection.setAttribute("transform",s),this._selectionHittest.setAttribute("transform",s),this._updateAnchors(),this},n._saveState=function(){!function(t){var e,n=[],i=t._selectedAnchors;for(e=0;e<i.length;e++)n[e]=i[e].i;ct.unshift({path:t,d:t.path.getAttribute("d"),transform:t.path.getAttribute("transform")||"",selectedIndexes:n}),ct.length>30&&(ct.length=30)}(this)},n._onClickSelectionPath=function(t){if("hidden"===this._selection.style.visibility)this.select();else if(Z||t&&t.altKey){var n,i,s,o,r,a,h={callbackScope:this,snap:this.vars.anchorSnap,onDrag:this._onDragAnchor,onPress:this._onPressAnchor,onRelease:this._onRelease,onClick:this._onClickAnchor,onDragEnd:this._onDragEndAnchor,maxX:this.vars.maxX,minX:this.vars.minX},c=this._selection.getScreenCTM().inverse();for(this._draggable&&this._draggable._onRelease(t),c&&(o=t.clientX*c.a+t.clientY*c.c+c.e,r=t.clientX*c.b+t.clientY*c.d+c.f),a=function(t,n,i){var s,o,r,a,h={j:0,i:0,t:0},c=l;for(o=0;o<t.length;o++)for(a=t[o],s=0;s<a.length;s+=6)r=A(1,n,i,0,1,20,a[s],a[s+1],a[s+2],a[s+3],a[s+4],a[s+5],a[s+6],a[s+7]),c>e&&(c=e,h.j=o,h.i=s,h.t=r);return h}(this._rawPath,o,r),function(t,e,n){if(n<=0||n>=1)return 0;var i=t[e],s=t[e+1],o=t[e+2],r=t[e+3],a=t[e+4],h=t[e+5],l=i+(o-i)*n,c=o+(a-o)*n,u=s+(r-s)*n,p=r+(h-r)*n,g=l+(c-l)*n,f=u+(p-u)*n,_=a+(t[e+6]-a)*n,v=h+(t[e+7]-h)*n;c+=(_-c)*n,p+=(v-p)*n,t.splice(e+2,4,d(l),d(u),d(g),d(f),d(g+(c-g)*n),d(f+(p-f)*n),d(c),d(p),d(_),d(v)),t.samples&&t.samples.splice(e/6*t.resolution|0,0,0,0,0,0,0,0)}(this._rawPath[a.j],a.i,a.t),n=a.i+6,i=0;i<this._anchors.length;i++)this._anchors[i].i>=n&&this._anchors[i].j===a.j&&(this._anchors[i].i+=6);s=new It(this,this._rawPath,a.j,n,h),this._selection.appendChild(this._handle1),this._selection.appendChild(this._handle2),s._draggable._onPress(t),Q=s,this._anchors.push(s),this._selectedAnchors.length=0,this._selectedAnchors.push(s),this._updateAnchors(),this.update(),this._saveState()}Mt(),Pt(G,"touchforcechange",ft),kt("onPress",this)},n._onClickHandle1=function(){var t=this._editingAnchor,e=t.i,n=t.segment,i=t.isClosedStart?n.length-4:e-2;Z&&Math.abs(n[e]-n[i])<5&&Math.abs(n[e+1]-n[i+1])<5&&this._onClickAnchor(t)},n._onClickHandle2=function(){var t=this._editingAnchor,e=t.i,n=t.segment;Z&&Math.abs(n[e]-n[e+2])<5&&Math.abs(n[e+1]-n[e+3])<5&&this._onClickAnchor(t)},n._onDragEndAnchor=function(t){Q=null,this._saveState()},n.isSelected=function(){return this._selectedAnchors.length>0||"visible"===this._selection.style.visibility},n.select=function(t){if(this._selection.style.visibility="visible",this._editingAnchor=null,this.path._gsSelection=!0,!0===t)for(var e=this._anchors.length;--e>-1;)this._selectedAnchors[e]=this._anchors[e];return-1===gt.indexOf(this)&&gt.push(this),this._updateAnchors(),this},n.deselect=function(){return this._selection.style.visibility="hidden",this._selectedAnchors.length=0,this._editingAnchor=null,this.path._gsSelection=!1,gt.splice(gt.indexOf(this),1),this._updateAnchors(),this},n._onDragPath=function(t){var e=this._selectionHittest.getAttribute("transform")||"translate(0,0)";this._selection.setAttribute("transform",e),this.path.setAttribute("transform",e)},n._onPressAnchor=function(t){-1===this._selectedAnchors.indexOf(t)?($||(this._selectedAnchors.length=0),this._selectedAnchors.push(t)):$&&(this._selectedAnchors.splice(this._selectedAnchors.indexOf(t),1),t._draggable.endDrag()),lt.x=t.segment[t.i],lt.y=t.segment[t.i+1],this._updateAnchors(),kt("onPress",this)},n._deleteSelectedAnchors=function(){for(var t,e,n,i,s=this._selectedAnchors,o=s.length;--o>-1;)for((t=s[o]).element.parentNode.removeChild(t.element),t._draggable.enabled(!1),e=t.i,i=t.j,e?e<t.segment.length-2?t.segment.splice(e-2,6):t.segment.splice(e-4,6):t.segment.splice(e,6),s.splice(o,1),this._anchors.splice(this._anchors.indexOf(t),1),n=0;n<this._anchors.length;n++)this._anchors[n].i>=e&&this._anchors[n].j===i&&(this._anchors[n].i-=6);this._updateAnchors(),this.update(),this._saveState(),this.vars.onDeleteAnchor&&this.vars.onDeleteAnchor.call(this.vars.callbackScope||this)},n._onClickAnchor=function(t){var e,n,i,s,o,r,a=t.i,h=t.segment,l=t.isClosedStart?h.length-4:a-2,c=1e3,d=!a||a>=h.length-2;Z&&Q!==t&&this._editingAnchor?(t.smooth=!t.smooth,d&&!t.isClosedStart&&(t.smooth=!1),t.element.setAttribute("d",t.smooth?this._circleHandle:this._squareHandle),!t.smooth||d&&!t.isClosedStart?t.smooth||d&&!t.isClosedStart||((a||t.isClosedStart)&&(h[l]=h[a],h[l+1]=h[a+1]),a<h.length-2&&(h[a+2]=h[a],h[a+3]=h[a+1]),this._updateAnchors(),this.update(),this._saveState()):(e=((e=Math.atan2(h[a+1]-h[l+1],h[a]-h[l]))+(n=Math.atan2(h[a+3]-h[a+1],h[a+2]-h[a])))/2,i=Lt(h,l,a),s=Lt(h,a,a+2),i<.2&&(i=Lt(h,a,l-4)/4,e=n||Math.atan2(h[a+7]-h[l-3],h[a+6]-h[l-4])),s<.2&&(s=Lt(h,a,a+6)/4,n=e||Math.atan2(h[a+7]-h[l-3],h[a+6]-h[l-4])),o=Math.sin(e),r=Math.cos(e),Math.abs(n-e)<Math.PI/2&&(o=-o,r=-r),h[l]=((h[a]+r*i)*c|0)/c,h[l+1]=((h[a+1]+o*i)*c|0)/c,h[a+2]=((h[a]-r*s)*c|0)/c,h[a+3]=((h[a+1]-o*s)*c|0)/c,this._updateAnchors(),this.update(),this._saveState())):$||(this._selectedAnchors.length=0,this._selectedAnchors.push(t)),Q=null,this._updateAnchors()},n._updateAnchors=function(){var t,e,n,i=1===this._selectedAnchors.length?this._selectedAnchors[0]:null,s=i?i.segment:null;for(this._editingAnchor=i,t=0;t<this._anchors.length;t++)this._anchors[t].element.style.fill=-1!==this._selectedAnchors.indexOf(this._anchors[t])?st:"white";i&&(this._handle1.setAttribute("d",i.smooth?this._circleHandle:this._squareHandle),this._handle2.setAttribute("d",i.smooth?this._circleHandle:this._squareHandle)),t=i?i.i:0,i&&(t||i.isClosedStart)?(e=i.isClosedStart?s[s.length-4]:s[t-2],n=i.isClosedStart?s[s.length-3]:s[t-1],this._handle1.style.visibility=this._line1.style.visibility=Z||e!==s[t]||n!==s[t+1]?"visible":"hidden",this._handle1.setAttribute("transform","translate("+e+pt+n+")"),this._line1.setAttribute("points",e+pt+n+pt+s[t]+pt+s[t+1])):this._handle1.style.visibility=this._line1.style.visibility="hidden",i&&t<s.length-2?(e=s[t+2],n=s[t+3],this._handle2.style.visibility=this._line2.style.visibility=Z||e!==s[t]||n!==s[t+1]?"visible":"hidden",this._handle2.setAttribute("transform","translate("+e+pt+n+")"),this._line2.setAttribute("points",s[t]+pt+s[t+1]+pt+e+pt+n)):this._handle2.style.visibility=this._line2.style.visibility="hidden"},n._onPressAlt=function(){var t=this._editingAnchor;t&&((t.i||t.isClosedStart)&&(this._handle1.style.visibility=this._line1.style.visibility="visible"),t.i<t.segment.length-2&&(this._handle2.style.visibility=this._line2.style.visibility="visible"))},n._onReleaseAlt=function(){var t,e,n,i=this._editingAnchor;i&&(t=i.segment,e=i.i,n=i.isClosedStart?t.length-4:e-2,t[e]===t[n]&&t[e+1]===t[n+1]&&(this._handle1.style.visibility=this._line1.style.visibility="hidden"),t[e]===t[e+2]&&t[e+1]===t[e+3]&&(this._handle2.style.visibility=this._line2.style.visibility="hidden"))},n._onPressHandle1=function(){this._editingAnchor.smooth&&(this._oppositeHandleLength=Lt(this._editingAnchor.segment,this._editingAnchor.i,this._editingAnchor.i+2)),kt("onPress",this)},n._onPressHandle2=function(){this._editingAnchor.smooth&&(this._oppositeHandleLength=Lt(this._editingAnchor.segment,this._editingAnchor.isClosedStart?this._editingAnchor.segment.length-4:this._editingAnchor.i-2,this._editingAnchor.i)),kt("onPress",this)},n._onReleaseHandle=function(t){this._onRelease(t),this._saveState()},n._onDragHandle1=function(){var t,e=this._editingAnchor,n=e.segment,i=e.i,s=e.isClosedStart?n.length-4:i-2,o=1e3,r=this._handle1._draggable.x,a=this._handle1._draggable.y;n[s]=r=(r*o|0)/o,n[s+1]=a=(a*o|0)/o,e.smooth&&(Z?(e.smooth=!1,e.element.setAttribute("d",this._squareHandle),this._handle1.setAttribute("d",this._squareHandle),this._handle2.setAttribute("d",this._squareHandle)):(t=Math.atan2(n[i+1]-a,n[i]-r),r=this._oppositeHandleLength*Math.cos(t),a=this._oppositeHandleLength*Math.sin(t),n[i+2]=((n[i]+r)*o|0)/o,n[i+3]=((n[i+1]+a)*o|0)/o)),this.update()},n._onDragHandle2=function(){var t,e=this._editingAnchor,n=e.segment,i=e.i,s=e.isClosedStart?n.length-4:i-2,o=1e3,r=this._handle2._draggable.x,a=this._handle2._draggable.y;n[i+2]=r=(r*o|0)/o,n[i+3]=a=(a*o|0)/o,e.smooth&&(Z?(e.smooth=!1,e.element.setAttribute("d",this._squareHandle),this._handle1.setAttribute("d",this._squareHandle),this._handle2.setAttribute("d",this._squareHandle)):(t=Math.atan2(n[i+1]-a,n[i]-r),r=this._oppositeHandleLength*Math.cos(t),a=this._oppositeHandleLength*Math.sin(t),n[s]=((n[i]+r)*o|0)/o,n[s+1]=((n[i+1]+a)*o|0)/o)),this.update()},n._onDragAnchor=function(t,e,n){var i,s,o,r,a,h=this._selectedAnchors,l=h.length,c=1e3;for(s=0;s<l;s++)i=(r=h[s]).i,o=r.segment,i?(o[i-2]=((o[i-2]+e)*c|0)/c,o[i-1]=((o[i-1]+n)*c|0)/c):r.isClosedStart&&(o[a=o.length-2]=yt(o[a]+e),o[a+1]=yt(o[a+1]+n),o[a-2]=yt(o[a-2]+e),o[a-1]=yt(o[a-1]+n)),o[i]=((o[i]+e)*c|0)/c,o[i+1]=((o[i+1]+n)*c|0)/c,i<o.length-2&&(o[i+2]=((o[i+2]+e)*c|0)/c,o[i+3]=((o[i+3]+n)*c|0)/c),r!==t&&r.element.setAttribute("transform","translate("+o[i]+pt+o[i+1]+")");this.update()},n.enabled=function(t){if(!arguments.length)return this._enabled;for(var e=this._anchors.length;--e>-1;)this._anchors[e]._draggable.enabled(t);return this._enabled=t,this._handle1._draggable.enabled(t),this._handle2._draggable.enabled(t),this._draggable&&this._draggable.enabled(t),t?this._selection.parentNode||(this.path.ownerSVGElement.appendChild(this._selectionHittest),this.path.ownerSVGElement.appendChild(this._selection),this.init(),this._saveState()):(this.deselect(),this._selectionHittest.parentNode&&this._selectionHittest.parentNode.removeChild(this._selectionHittest),this._selection.parentNode&&this._selection.parentNode.removeChild(this._selection)),this._updateAnchors(),this.update()},n.update=function(t){var e,n,i,s,o,r="",a=this._editingAnchor;if(t&&this.init(),a&&(e=a.i,n=a.segment,(e||a.isClosedStart)&&(i=n[o=a.isClosedStart?n.length-4:e-2],s=n[o+1],this._handle1.setAttribute("transform","translate("+i+pt+s+")"),this._line1.setAttribute("points",i+pt+s+pt+n[e]+pt+n[e+1])),e<n.length-2&&(i=n[e+2],s=n[e+3],this._handle2.setAttribute("transform","translate("+i+pt+s+")"),this._line2.setAttribute("points",n[e]+pt+n[e+1]+pt+i+pt+s))),t)r=this.path.getAttribute("d");else{for(e=0;e<this._rawPath.length;e++)(n=this._rawPath[e]).length>7&&(r+="M"+n[0]+pt+n[1]+"C"+n.slice(2).join(pt));this.path.setAttribute("d",r),this._selectionPath.setAttribute("d",r),this._selectionHittest.setAttribute("d",r)}return this.vars.onUpdate&&this._enabled&&kt("onUpdate",this,r),this},n.getRawPath=function(t,e,n){if(t){var i=bt(this.path);return g(p(this._rawPath),1,0,0,1,i.e+(e||0),i.f+(n||0))}return this._rawPath},n.getString=function(t,e,n){if(t){var i=bt(this.path);return function(t){"number"==typeof t[0]&&(t=[t]);var e,n,i,s,o="",r=t.length;for(n=0;n<r;n++){for(s=t[n],o+="M"+d(s[0])+","+d(s[1])+" C",e=s.length,i=2;i<e;i++)o+=d(s[i++])+","+d(s[i++])+" "+d(s[i++])+","+d(s[i++])+" "+d(s[i++])+","+d(s[i])+" ";s.closed&&(o+="z")}return o}(g(p(this._rawPath),1,0,0,1,i.e+(e||0),i.f+(n||0)))}return this.path.getAttribute("d")},n.getNormalizedSVG=function(t,e,n,i){var s,o,r,a,h,l,c=this._rawPath[0],d=-1*c[0],u=0===e?0:-(e||c[1]),p=c.length,g=1/(c[p-2]+d),f=-t||c[p-1]+u,_=1e3;for(ut.length=0,f=f?1/f:-g,g*=_,f*=_,o=0;o<p;o+=2)ut[o]=((c[o]+d)*g|0)/_,ut[o+1]=((c[o+1]+u)*f|0)/_;if(i){for(s=[],p=ut.length,o=2;o<p;o+=6)r=ut[o-2],a=ut[o-1],h=ut[o+4],l=ut[o+5],s.push(r,a,h,l),v(r,a,ut[o],ut[o+1],ut[o+2],ut[o+3],h,l,.001,s,s.length-2);for(r=s[0],p=s.length,o=2;o<p;o+=2){if((h=s[o])<r||h>1||h<0){i();break}r=h}}return n&&8===p&&0===ut[0]&&0===ut[1]&&1===ut[p-2]&&1===ut[p-1]?ut.slice(2,6).join(","):(ut[2]="C"+ut[2],"M"+ut.join(","))},n.kill=function(){this.enabled(!1),this._g.parentNode&&this._g.parentNode.removeChild(this._g)},n.revert=function(){this.kill()},t}();Ot.simplifyPoints=y,Ot.pointsToSegment=m,Ot.simplifySVG=function(t,e){var n,i,s,o,r,a,h,l,c,d,u;if(d=(e=e||{}).tolerance||1,c=e.precision||1/d,void 0===e.cornerThreshold||e.cornerThreshold,"string"!=typeof t&&(t=(n=t).getAttribute("d")),"#"!==t.charAt(0)&&"."!==t.charAt(0)||(n=V.querySelector(t))&&(t=n.getAttribute("d")),i=!1!==e.curved||/[achqstvz]/gi.test(t)?_(t)[0]:t.match(it),!1!==e.curved){for(l=i,i=[],u=l.length,s=2;s<u;s+=6)o=+l[s-2],a=+l[s-1],r=+l[s+4],h=+l[s+5],i.push(yt(o),yt(a),yt(r),yt(h)),v(o,a,+l[s],+l[s+1],+l[s+2],+l[s+3],r,h,1/(2e5*c),i,i.length-2);(i=m(y(i,d),e.curviness))[2]="C"+i[2]}else i=y(i,d);return t="M"+i.join(","),n&&n.setAttribute("d",t),t},Ot.create=function(t,e){return new Ot(t,e)},Ot.editingAxis=lt,Ot.getSnapFunction=function(t){var e=t.radius||2,n=1e20,i=t.x||0===t.x?t.x:t.width?0:-n,s=t.y||0===t.y?t.y:t.height?0:-n,o=i+(t.width||n*n),r=s+(t.height||n*n),a=!1!==t.containX,h=!1!==t.containY,l=t.axis,c=t.gridSize;return e*=e,function(t){var n,d,u,p,g=t.x,f=t.y;a&&g<i||(u=g-i)*u<e?g=i:(a&&g>o||(u=o-g)*u<e)&&(g=o),h&&f<s||(p=f-s)*p<e?f=s:(h&&f>r||(p=r-f)*p<e)&&(f=r),l&&(u=g-l.x,p=f-l.y,u*u<e&&(g=l.x),p*p<e&&(f=l.y)),c&&(u=(n=i+Math.round((g-i)/c)*c)-g)*u+(p=(d=s+Math.round((f-s)/c)*c)-f)*p<e&&(g=n,f=d),t.x=g,t.y=f}},Ot.version="3.13.0",Ot.register=Dt;var qt,Yt,jt,Vt,zt,Gt,Bt,Wt,Ft,Ut,Zt=/(^[#\.][a-z]|[a-y][a-z])/i,$t=function(t){return"string"==typeof t},Kt=function(t,e){var n=jt.createElementNS?jt.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):jt.createElement(t);return n.style?n:jt.createElement(t)},Qt=function(t,e,n){return $t(t)&&Zt.test(t)?jt.querySelector(t):Array.isArray(t)?Wt(Bt([{x:qt.getProperty(e,"x"),y:qt.getProperty(e,"y")}].concat(t),n)):$t(t)||t&&"path"===(t.tagName+"").toLowerCase()?t:0},Jt={matrix:{a:1,b:0,c:0,d:1,e:0,f:0}},te=function(t,e){var n="Please gsap.registerPlugin(MotionPathPlugin)";Yt=window,(qt=qt||t||Yt.gsap||console.warn(n))&&Ot.register(qt),jt=document,zt=jt.body,Vt=jt.documentElement,qt&&(Gt=qt.plugins.motionPath,ee.PathEditor=Ot,Ft=qt.core.context||function(){}),Gt?((Ut=Kt("textarea")).style.display="none",zt.appendChild(Ut),Bt=Gt.arrayToRawPath,Wt=Gt.rawPathToString):!0===e&&console.warn(n)},ee=function(){function t(t,e){var n=this;void 0===e&&(e={}),Gt||te(e.gsap,1);var i,s,o,r,a,h,l,c,d,u,p,g,f,_,v=Kt("div"),m=this,b={x:0,y:0};t instanceof qt.core.Tween?i=(c=t).targets()[0]:(i=qt.utils.toArray(t)[0],c=function(t){for(var e=qt.getTweensOf(t),n=0;n<e.length;n++){if(e[n].vars.motionPath)return e[n];e[n].timeline&&e.push.apply(e,e[n].timeline.getChildren())}}(i)),s=Qt(e.path,i,e),this.offset=b,h=function(t){var e=t.getBoundingClientRect(),n=Vt.clientTop-(Yt.pageYOffset||Vt.scrollTop||zt.scrollTop||0),i=Vt.clientLeft-(Yt.pageXOffset||Vt.scrollLeft||zt.scrollLeft||0);return{left:e.left+i,top:e.top+n,right:e.right+i,bottom:e.bottom+n}}(i),r=parseFloat(qt.getProperty(i,"x","px")),a=parseFloat(qt.getProperty(i,"y","px")),o=i.getCTM&&"svg"!==i.tagName.toLowerCase(),c&&!s&&(s=Qt(c.vars.motionPath.path||c.vars.motionPath,i,c.vars.motionPath)),v.setAttribute("class","copy-motion-path"),v.style.cssText="border-radius:8px; background-color:rgba(85, 85, 85, 0.7); color:#fff; cursor:pointer; padding:6px 12px; font-family:Signika Negative, Arial, sans-serif; position:fixed; left:50%; transform:translate(-50%, 0); font-size:19px; bottom:10px",v.innerText="COPY MOTION PATH",v._gsHelper=m,(qt.utils.toArray(e.container)[0]||zt).appendChild(v),function(t,e,n){t.addEventListener("click",(function(t){if(t.target._gsHelper){var e=(t.target,m.getString());if(Ut.value=e,e&&Ut.select){console.log(e),Ut.style.display="block",Ut.select();try{jt.execCommand("copy"),Ut.blur(),n&&n()}catch(t){console.warn("Copy didn't work; this browser doesn't permit that.")}Ut.style.display="none"}}}))}(v,0,(function(){return qt.fromTo(v,{backgroundColor:"white"},{duration:.5,backgroundColor:"rgba(85, 85, 85, 0.6)"})})),(l=s&&s.ownerSVGElement)?(e.pathColor&&qt.set(s,{stroke:e.pathColor}),e.pathWidth&&qt.set(s,{strokeWidth:e.pathWidth}),e.pathOpacity&&qt.set(s,{opacity:e.pathOpacity})):(d=o&&i.ownerSVGElement&&i.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg",o?(l=i.ownerSVGElement,u=i.getBBox(),p=function(t){return(t.transform.baseVal.consolidate()||Jt).matrix}(i),r=p.e,a=p.f,b.x=u.x,b.y=u.y):(l=Kt("svg",d),_=!0,zt.appendChild(l),l.setAttribute("viewBox","0 0 100 100"),l.setAttribute("class","motion-path-helper"),l.style.cssText="overflow:visible; background-color: transparent; position:absolute; z-index:5000; width:100px; height:100px; top:"+(h.top-a)+"px; left:"+(h.left-r)+"px;"),u=$t(s)&&!Zt.test(s)?s:function(t,e){var n,i=[0,31,8,58,24,75,40,90,69,100,100,100];for(n=0;n<i.length;n+=2)i[n]+=t,i[n+1]+=e;return"M"+t+","+e+"C"+i.join(",")}(r,a),(s=Kt("path",d)).setAttribute("d",u),s.setAttribute("vector-effect","non-scaling-stroke"),s.style.cssText="fill:transparent; stroke-width:"+(e.pathWidth||3)+"; stroke:"+(e.pathColor||"#555")+"; opacity:"+(e.pathOpacity||.6),l.appendChild(s)),(b.x||b.y)&&qt.set(s,{x:b.x,y:b.y}),"selected"in e||(e.selected=!0),"anchorSnap"in e||(e.anchorSnap=function(t){t.x*t.x+t.y*t.y<16&&(t.x=t.y=0)}),f=c&&c.parent&&"nested"===c.parent.data?c.parent.parent:c,e.onPress=function(){f.pause(0)},g=function(){c.invalidate(),f.restart()},e.onRelease=e.onDeleteAnchor=g,this.editor=Ot.create(s,e),e.center&&qt.set(i,{transformOrigin:"50% 50%",xPercent:-50,yPercent:-50}),c?(c.vars.motionPath.path?c.vars.motionPath.path=s:c.vars.motionPath={path:s},f.parent!==qt.globalTimeline&&qt.globalTimeline.add(f,function(t){for(var e=t.totalTime();t;)e=t.startTime()+e/(t.timeScale()||1),t=t.parent;return e}(f)-f.delay()),f.repeat(-1).repeatDelay(1)):c=f=qt.to(i,{motionPath:{path:s,start:e.start||0,end:"end"in e?e.end:1,autoRotate:"autoRotate"in e&&e.autoRotate,align:s,alignOrigin:e.alignOrigin},duration:e.duration||5,ease:e.ease||"power1.inOut",repeat:-1,repeatDelay:1,paused:!e.path}),this.animation=c,Ft(this),this.kill=this.revert=function(){n.editor.kill(),v.parentNode&&v.parentNode.removeChild(v),_&&l.parentNode&&l.parentNode.removeChild(l),f&&f.revert()}}return t.prototype.getString=function(){return this.editor.getString(!0,-this.offset.x,-this.offset.y)},t}();ee.register=te,ee.create=function(t,e){return new ee(t,e)},ee.editPath=function(t,e){return Ot.create(t,e)},ee.version="3.13.0",t.MotionPathHelper=ee,t.default=ee,Object.defineProperty(t,"__esModule",{value:!0})}));