import{h as e,o as t}from"../shared/utils.min.mjs";function o({swiper:o,extendParams:s,emit:i,once:n}){s({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}}),Object.assign(o,{freeMode:{onTouchStart:function(){if(o.params.cssMode)return;const e=o.getTranslate();o.setTranslate(e),o.setTransition(0),o.touchEventsData.velocities.length=0,o.freeMode.onTouchEnd({currentPos:o.rtl?o.translate:-o.translate})},onTouchMove:function(){if(o.params.cssMode)return;const{touchEventsData:t,touches:s}=o;0===t.velocities.length&&t.velocities.push({position:s[o.isHorizontal()?"startX":"startY"],time:t.touchStartTime}),t.velocities.push({position:s[o.isHorizontal()?"currentX":"currentY"],time:e()})},onTouchEnd:function({currentPos:s}){if(o.params.cssMode)return;const{params:a,wrapperEl:r,rtlTranslate:l,snapGrid:m,touchEventsData:c}=o,d=e()-c.touchStartTime;if(s<-o.minTranslate())o.slideTo(o.activeIndex);else if(s>-o.maxTranslate())o.slides.length<m.length?o.slideTo(m.length-1):o.slideTo(o.slides.length-1);else{if(a.freeMode.momentum){if(c.velocities.length>1){const t=c.velocities.pop(),s=c.velocities.pop(),i=t.position-s.position,n=t.time-s.time;o.velocity=i/n,o.velocity/=2,Math.abs(o.velocity)<a.freeMode.minimumVelocity&&(o.velocity=0),(n>150||e()-t.time>300)&&(o.velocity=0)}else o.velocity=0;o.velocity*=a.freeMode.momentumVelocityRatio,c.velocities.length=0;let s=1e3*a.freeMode.momentumRatio;const d=o.velocity*s;let u=o.translate+d;l&&(u=-u);let f,p=!1;const M=20*Math.abs(o.velocity)*a.freeMode.momentumBounceRatio;let T;if(u<o.maxTranslate())a.freeMode.momentumBounce?(u+o.maxTranslate()<-M&&(u=o.maxTranslate()-M),f=o.maxTranslate(),p=!0,c.allowMomentumBounce=!0):u=o.maxTranslate(),a.loop&&a.centeredSlides&&(T=!0);else if(u>o.minTranslate())a.freeMode.momentumBounce?(u-o.minTranslate()>M&&(u=o.minTranslate()+M),f=o.minTranslate(),p=!0,c.allowMomentumBounce=!0):u=o.minTranslate(),a.loop&&a.centeredSlides&&(T=!0);else if(a.freeMode.sticky){let e;for(let t=0;t<m.length;t+=1)if(m[t]>-u){e=t;break}u=Math.abs(m[e]-u)<Math.abs(m[e-1]-u)||"next"===o.swipeDirection?m[e]:m[e-1],u=-u}if(T&&n("transitionEnd",(()=>{o.loopFix()})),0!==o.velocity){if(s=l?Math.abs((-u-o.translate)/o.velocity):Math.abs((u-o.translate)/o.velocity),a.freeMode.sticky){const e=Math.abs((l?-u:u)-o.translate),t=o.slidesSizesGrid[o.activeIndex];s=e<t?a.speed:e<2*t?1.5*a.speed:2.5*a.speed}}else if(a.freeMode.sticky)return void o.slideToClosest();a.freeMode.momentumBounce&&p?(o.updateProgress(f),o.setTransition(s),o.setTranslate(u),o.transitionStart(!0,o.swipeDirection),o.animating=!0,t(r,(()=>{o&&!o.destroyed&&c.allowMomentumBounce&&(i("momentumBounce"),o.setTransition(a.speed),setTimeout((()=>{o.setTranslate(f),t(r,(()=>{o&&!o.destroyed&&o.transitionEnd()}))}),0))}))):o.velocity?(i("_freeModeNoMomentumRelease"),o.updateProgress(u),o.setTransition(s),o.setTranslate(u),o.transitionStart(!0,o.swipeDirection),o.animating||(o.animating=!0,t(r,(()=>{o&&!o.destroyed&&o.transitionEnd()})))):o.updateProgress(u),o.updateActiveIndex(),o.updateSlidesClasses()}else{if(a.freeMode.sticky)return void o.slideToClosest();a.freeMode&&i("_freeModeNoMomentumRelease")}(!a.freeMode.momentum||d>=a.longSwipesMs)&&(i("_freeModeStaticRelease"),o.updateProgress(),o.updateActiveIndex(),o.updateSlidesClasses())}}}})}export{o as default};