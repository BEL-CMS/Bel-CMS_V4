import{a as e}from"../shared/ssr-window.esm.mjs";function a({swiper:a,extendParams:t,on:s}){t({history:{enabled:!1,root:"",replaceState:!1,key:"slides",keepQuery:!1}});let r=!1,l={};const i=e=>e.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""),o=a=>{const t=e();let s;s=a?new URL(a):t.location;const r=s.pathname.slice(1).split("/").filter((e=>""!==e)),l=r.length;return{key:r[l-2],value:r[l-1]}},n=(t,s)=>{const l=e();if(!r||!a.params.history.enabled)return;let o;o=a.params.url?new URL(a.params.url):l.location;const n=a.virtual&&a.params.virtual.enabled?a.slidesEl.querySelector(`[data-swiper-slide-index="${s}"]`):a.slides[s];let p=i(n.getAttribute("data-history"));if(a.params.history.root.length>0){let e=a.params.history.root;"/"===e[e.length-1]&&(e=e.slice(0,e.length-1)),p=`${e}/${t?`${t}/`:""}${p}`}else o.pathname.includes(t)||(p=`${t?`${t}/`:""}${p}`);a.params.history.keepQuery&&(p+=o.search);const d=l.history.state;d&&d.value===p||(a.params.history.replaceState?l.history.replaceState({value:p},null,p):l.history.pushState({value:p},null,p))},p=(e,t,s)=>{if(t)for(let r=0,l=a.slides.length;r<l;r+=1){const l=a.slides[r];if(i(l.getAttribute("data-history"))===t){const t=a.getSlideIndex(l);a.slideTo(t,e,s)}}else a.slideTo(0,e,s)},d=()=>{l=o(a.params.url),p(a.params.speed,l.value,!1)};s("init",(()=>{a.params.history.enabled&&(()=>{const t=e();if(a.params.history){if(!t.history||!t.history.pushState)return a.params.history.enabled=!1,void(a.params.hashNavigation.enabled=!0);r=!0,l=o(a.params.url),l.key||l.value?(p(0,l.value,a.params.runCallbacksOnInit),a.params.history.replaceState||t.addEventListener("popstate",d)):a.params.history.replaceState||t.addEventListener("popstate",d)}})()})),s("destroy",(()=>{a.params.history.enabled&&(()=>{const t=e();a.params.history.replaceState||t.removeEventListener("popstate",d)})()})),s("transitionEnd _freeModeNoMomentumRelease",(()=>{r&&n(a.params.history.key,a.activeIndex)})),s("slideChange",(()=>{r&&a.params.cssMode&&n(a.params.history.key,a.activeIndex)}))}export{a as default};