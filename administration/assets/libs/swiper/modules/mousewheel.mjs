import{a as e}from"../shared/ssr-window.esm.mjs";import{n as a,h as t}from"../shared/utils.mjs";function s({swiper:s,extendParams:n,on:l,emit:i}){const r=e();let o;n({mousewheel:{enabled:!1,releaseOnEdges:!1,invert:!1,forceToAxis:!1,sensitivity:1,eventsTarget:"container",thresholdDelta:null,thresholdTime:null,noMousewheelClass:"swiper-no-mousewheel"}}),s.mousewheel={enabled:!1};let d,m=t();const p=[];function u(){s.enabled&&(s.mouseEntered=!0)}function h(){s.enabled&&(s.mouseEntered=!1)}function c(e){return!(s.params.mousewheel.thresholdDelta&&e.delta<s.params.mousewheel.thresholdDelta||s.params.mousewheel.thresholdTime&&t()-m<s.params.mousewheel.thresholdTime||!(e.delta>=6&&t()-m<60)&&(e.direction<0?s.isEnd&&!s.params.loop||s.animating||(s.slideNext(),i("scroll",e.raw)):s.isBeginning&&!s.params.loop||s.animating||(s.slidePrev(),i("scroll",e.raw)),m=(new r.Date).getTime(),1))}function w(e){let n=e,l=!0;if(!s.enabled)return;if(e.target.closest(`.${s.params.mousewheel.noMousewheelClass}`))return;const r=s.params.mousewheel;s.params.cssMode&&n.preventDefault();let m=s.el;"container"!==s.params.mousewheel.eventsTarget&&(m=document.querySelector(s.params.mousewheel.eventsTarget));const u=m&&m.contains(n.target);if(!s.mouseEntered&&!u&&!r.releaseOnEdges)return!0;n.originalEvent&&(n=n.originalEvent);let h=0;const w=s.rtlTranslate?-1:1,f=function(e){let a=0,t=0,s=0,n=0;return"detail"in e&&(t=e.detail),"wheelDelta"in e&&(t=-e.wheelDelta/120),"wheelDeltaY"in e&&(t=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(a=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(a=t,t=0),s=10*a,n=10*t,"deltaY"in e&&(n=e.deltaY),"deltaX"in e&&(s=e.deltaX),e.shiftKey&&!s&&(s=n,n=0),(s||n)&&e.deltaMode&&(1===e.deltaMode?(s*=40,n*=40):(s*=800,n*=800)),s&&!a&&(a=s<1?-1:1),n&&!t&&(t=n<1?-1:1),{spinX:a,spinY:t,pixelX:s,pixelY:n}}(n);if(r.forceToAxis)if(s.isHorizontal()){if(!(Math.abs(f.pixelX)>Math.abs(f.pixelY)))return!0;h=-f.pixelX*w}else{if(!(Math.abs(f.pixelY)>Math.abs(f.pixelX)))return!0;h=-f.pixelY}else h=Math.abs(f.pixelX)>Math.abs(f.pixelY)?-f.pixelX*w:-f.pixelY;if(0===h)return!0;r.invert&&(h=-h);let g=s.getTranslate()+h*r.sensitivity;if(g>=s.minTranslate()&&(g=s.minTranslate()),g<=s.maxTranslate()&&(g=s.maxTranslate()),l=!!s.params.loop||!(g===s.minTranslate()||g===s.maxTranslate()),l&&s.params.nested&&n.stopPropagation(),s.params.freeMode&&s.params.freeMode.enabled){const e={time:t(),delta:Math.abs(h),direction:Math.sign(h)},l=d&&e.time<d.time+500&&e.delta<=d.delta&&e.direction===d.direction;if(!l){d=void 0;let t=s.getTranslate()+h*r.sensitivity;const m=s.isBeginning,u=s.isEnd;if(t>=s.minTranslate()&&(t=s.minTranslate()),t<=s.maxTranslate()&&(t=s.maxTranslate()),s.setTransition(0),s.setTranslate(t),s.updateProgress(),s.updateActiveIndex(),s.updateSlidesClasses(),(!m&&s.isBeginning||!u&&s.isEnd)&&s.updateSlidesClasses(),s.params.loop&&s.loopFix({direction:e.direction<0?"next":"prev",byMousewheel:!0}),s.params.freeMode.sticky){clearTimeout(o),o=void 0,p.length>=15&&p.shift();const t=p.length?p[p.length-1]:void 0,n=p[0];if(p.push(e),t&&(e.delta>t.delta||e.direction!==t.direction))p.splice(0);else if(p.length>=15&&e.time-n.time<500&&n.delta-e.delta>=1&&e.delta<=6){const t=h>0?.8:.2;d=e,p.splice(0),o=a((()=>{!s.destroyed&&s.params&&s.slideToClosest(s.params.speed,!0,void 0,t)}),0)}o||(o=a((()=>{!s.destroyed&&s.params&&(d=e,p.splice(0),s.slideToClosest(s.params.speed,!0,void 0,.5))}),500))}if(l||i("scroll",n),s.params.autoplay&&s.params.autoplay.disableOnInteraction&&s.autoplay.stop(),r.releaseOnEdges&&(t===s.minTranslate()||t===s.maxTranslate()))return!0}}else{const a={time:t(),delta:Math.abs(h),direction:Math.sign(h),raw:e};p.length>=2&&p.shift();const n=p.length?p[p.length-1]:void 0;if(p.push(a),n?(a.direction!==n.direction||a.delta>n.delta||a.time>n.time+150)&&c(a):c(a),function(e){const a=s.params.mousewheel;if(e.direction<0){if(s.isEnd&&!s.params.loop&&a.releaseOnEdges)return!0}else if(s.isBeginning&&!s.params.loop&&a.releaseOnEdges)return!0;return!1}(a))return!0}return n.preventDefault?n.preventDefault():n.returnValue=!1,!1}function f(e){let a=s.el;"container"!==s.params.mousewheel.eventsTarget&&(a=document.querySelector(s.params.mousewheel.eventsTarget)),a[e]("mouseenter",u),a[e]("mouseleave",h),a[e]("wheel",w)}function g(){return s.params.cssMode?(s.wrapperEl.removeEventListener("wheel",w),!0):!s.mousewheel.enabled&&(f("addEventListener"),s.mousewheel.enabled=!0,!0)}function v(){return s.params.cssMode?(s.wrapperEl.addEventListener(event,w),!0):!!s.mousewheel.enabled&&(f("removeEventListener"),s.mousewheel.enabled=!1,!0)}l("init",(()=>{!s.params.mousewheel.enabled&&s.params.cssMode&&v(),s.params.mousewheel.enabled&&g()})),l("destroy",(()=>{s.params.cssMode&&g(),s.mousewheel.enabled&&v()})),Object.assign(s.mousewheel,{enable:g,disable:v})}export{s as default};